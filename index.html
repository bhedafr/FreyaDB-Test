<!DOCTYPE html>
<html>
<head>
    <title>Product Categories and Names</title>
</head>
<body>
    <h1>Hello World</h1>

    <?php
    try {
        // PHP Data Objects(PDO) Sample Code:
        $conn = new PDO("sqlsrv:server = tcp:it-ccdv-sql-freyatest.database.windows.net,1433; Database = IT-CCDV-DB-FreyaTest", "rootAdmin", "{Sheridan!321}");
        $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

        // SQL query
        $sql = "SELECT TOP 20 pc.Name as CategoryName, p.name as ProductName
                FROM SalesLT.ProductCategory pc
                JOIN SalesLT.Product p
                ON pc.productcategoryid = p.productcategoryid";

        // Execute the query
        $stmt = $conn->query($sql);

        // Check if any rows were returned
        if ($stmt->rowCount() > 0) {
            echo "<table border='1'>";
            echo "<tr><th>Category Name</th><th>Product Name</th></tr>";
            
            // Fetch and display the results in a table
            while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
                echo "<tr><td>" . $row['CategoryName'] . "</td><td>" . $row['ProductName'] . "</td></tr>";
            }
            
            echo "</table>";
        } else {
            echo "No records found.";
        }

    } catch (PDOException $e) {
        print("Error connecting to SQL Server.");
        die(print_r($e));
    }
    ?>
</body>
</html>
